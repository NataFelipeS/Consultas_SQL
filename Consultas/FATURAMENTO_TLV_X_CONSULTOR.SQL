SELECT DISTINCT
    CT.PESSOA_DOCCOM,
    TLV.RAZAOSOCIAL_PESSOA,
    CL.PESSOA_DOCCOM,
    CONS.RAZAOSOCIAL_PESSOA,
    SUM(DOCUMENTO_FATURA.VLRLIQUIDO_DOCFAT) AS TOTAL,
    SUM(DOCUMENTO_FATURA.VLRLIQUIDO_DOCFAT) / 12 AS MESES
FROM DOCUMENTO_FATURA
    INNER JOIN DOCUMENTO_COMISSAO CT ON DOCUMENTO_FATURA.CODIGO_DOCFAT = CT.DOCUMENTO_DOCCOM 
    INNER JOIN PESSOA TLV ON TLV.CODIGO_PESSOA = CT.PESSOA_DOCCOM
    INNER JOIN DOCUMENTO_COMISSAO CL ON DOCUMENTO_FATURA.CODIGO_DOCFAT = CL.DOCUMENTO_DOCCOM 
    INNER JOIN PESSOA CONS ON CONS.CODIGO_PESSOA = CL.PESSOA_DOCCOM
WHERE
    (CAST(DOCUMENTO_FATURA.DTEMISSAO_DOCFAT AS DATE) BETWEEN '2025-02-01' AND '2025-03-01' AND
    (CT.TIPOPESSOA_DOCCOM = 3) AND
    (CL.TIPOPESSOA_DOCCOM = 0) AND
    (DOCUMENTO_FATURA.STATUS_DOCFAT IN (11,13,14)))
GROUP BY
    CT.PESSOA_DOCCOM,
    TLV.RAZAOSOCIAL_PESSOA,
    CL.PESSOA_DOCCOM,
    CONS.RAZAOSOCIAL_PESSOA

-- NICIOLI
