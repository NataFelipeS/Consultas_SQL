SELECT 
    EXTRACT(YEAR FROM NF.DATAEMISSAO_NF) AS ANO,
    COUNT(DISTINCT NF.AUTOINC_NF) AS QTD_VENDAS,
    SUM(NF.VALORTOTAL_NF) AS VALOR_VENDIDO,
    ROUND(SUM(DF.QTDETOTALITENS_DOCFAT)) AS QTD_ITENS
FROM NOTA_FISCAL NF
INNER JOIN DOCUMENTO_FATURA DF 
    ON DF.CODIGO_DOCFAT = NF.LISTA_PEDIDOS_NF AND NF.LISTA_PEDIDOS_NF NOT LIKE '%/%' -- Retirei alguns registros que contavam como string, mas é irrelevante, pois são 26 registros apenas de assistência.
GROUP BY 
    EXTRACT(YEAR FROM NF.DATAEMISSAO_NF);