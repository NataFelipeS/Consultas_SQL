SELECT
	I.CODIGO_ITEM,
	I.DESCRICAO_ITEM,
	I.TIPOPRODUTO_ITEM,
	SUM(DI.QTDEPEDIDO_DOCITEM) AS QUANTIDADE,
	SUM(DI.VLRTOTALLIQUIDO_DOCITEM) AS TOTAL_VENDIDO,
	EXTRACT(YEAR FROM DF.DTEMISSAO_DOCFAT) AS ANO
FROM ITEM I
	INNER JOIN DOCUMENTO_ITEM DI ON I.CODIGO_ITEM = DI.ITEM_DOCITEM
  INNER JOIN DOCUMENTO_FATURA DF ON DF.CODIGO_DOCFAT = DI.DOCUMENTO_DOCITEM
WHERE
	cast(DF.DTEMISSAO_DOCFAT as date) BETWEEN '2025-03-01' AND '2025-04-23' AND
	DF.CLASSIFICACAO_DOCFAT = 1 AND
	DF.STATUS_DOCFAT NOT IN (4,5,7)
GROUP BY
	EXTRACT(YEAR FROM DF.DTEMISSAO_DOCFAT),
	I.CODIGO_ITEM,
	I.DESCRICAO_ITEM,
	I.TIPOPRODUTO_ITEM
ORDER BY TOTAL_VENDIDO DESC;