SELECT
	CASE EXTRACT(WEEKDAY FROM DC.DATAHORAINCLUSAO_DOCCOM)
	WHEN 1 THEN 'Segunda'
	WHEN 2 THEN 'Terça'
	WHEN 3 THEN 'Quarta'
	WHEN 4 THEN 'Quinta'
	WHEN 5 THEN 'Sexta'
	WHEN 6 THEN 'Sábado'
	WHEN 7 THEN 'Domingo' END AS dias_da_semana,
	P.CODIGO_PESSOA,
	P.RAZAOSOCIAL_PESSOA,
	SUM(NF.VALORTOTAL_NF) AS SOMA
FROM DOCUMENTO_COMISSAO DC
	INNER JOIN PESSOA P ON DC.PESSOA_DOCCOM = P.CODIGO_PESSOA
	INNER JOIN NOTA_FISCAL NF ON DC.DOCUMENTO_DOCCOM = NF.LISTA_PEDIDOS_NF AND NF.LISTA_PEDIDOS_NF NOT LIKE '%/%'
	INNER JOIN DOCUMENTO_FATURA DF ON DF.CODIGO_DOCFAT = DC.DOCUMENTO_DOCCOM
WHERE 
	P.RAZAOSOCIAL_PESSOA LIKE 'TELEVENDAS01' AND
	NF.TRANSACAO_NF IN (2,20,110,119,121,350) AND
	DF.CLASSIFICACAO_DOCFAT = 1
GROUP BY
	EXTRACT(WEEKDAY FROM DC.DATAHORAINCLUSAO_DOCCOM),
	P.CODIGO_PESSOA,
	P.RAZAOSOCIAL_PESSOA
	
	