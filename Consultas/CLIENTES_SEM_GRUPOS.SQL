SELECT 
	CODIGO_PESSOA,
	RAZAOSOCIAL_PESSOA,
	GRUPO_PESSOA,
	DATAHORAINCLUSAO_PESSOA,
	COUNT(*) OVER() AS TOTAL_REGISTROS
FROM (SELECT DISTINCT
	CODIGO_PESSOA,
	RAZAOSOCIAL_PESSOA,
	GRUPO_PESSOA,
	DATAHORAINCLUSAO_PESSOA
FROM PESSOA
	INNER JOIN DOCUMENTO_FATURA ON CLIENTE_DOCFAT = CODIGO_PESSOA
WHERE 
	DTEMISSAO_DOCFAT BETWEEN '2025-04-01' AND '2025-04-23' AND
	GRUPO_PESSOA = 0 AND
	STATUS_PESSOA = 0 AND
	TIPO_PESSOA = 'J') AS SUB
ORDER BY 
	DATAHORAINCLUSAO_PESSOA DESC;